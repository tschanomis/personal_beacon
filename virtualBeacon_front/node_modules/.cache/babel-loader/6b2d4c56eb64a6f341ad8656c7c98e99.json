{"ast":null,"code":"var _jsxFileName = \"/home/indien/personal_beacon/VirtualBeacon_front/src/components/Stats.js\";\nimport React from 'react';\nimport axios from 'axios';\nimport moment from 'moment';\nimport './Stats.css';\nimport StatChart from './StatChart';\n\nclass Stats extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      stats: [],\n      series: [{\n        name: \"\",\n        data: []\n      }]\n    };\n\n    this.componentDidMount = () => {\n      const token = this.props.giveToken;\n      const config = {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      };\n      axios.get(\"http://ec2-18-218-63-27.us-east-2.compute.amazonaws.com:443/api/logs\", config).then(result => {\n        if (result.status === 200) {\n          const stats = result.data;\n          this.setState({\n            stats: stats\n          });\n          const classifyResult = [];\n\n          for (let i = 7; i >= 0; i--) {\n            classifyResult.push(this.state.stats.filter(element => moment(element.created_at).format('YYYY-MM-D') === moment().subtract(i, 'days').format('YYYY-MM-D')).length);\n          }\n\n          ;\n          this.setState({\n            series: [{\n              name: \"Activations\",\n              data: classifyResult\n            }]\n          });\n        } else {\n          console.log(\"erreur\");\n        }\n      }).catch(e => {\n        console.log(\"erreur\");\n        this.props.getTokenError();\n      });\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"Stats\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(StatChart, {\n      series: this.state.series,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 5\n      }\n    }));\n  }\n\n}\n\nexport default Stats;","map":{"version":3,"sources":["/home/indien/personal_beacon/VirtualBeacon_front/src/components/Stats.js"],"names":["React","axios","moment","StatChart","Stats","Component","state","stats","series","name","data","componentDidMount","token","props","giveToken","config","headers","Authorization","get","then","result","status","setState","classifyResult","i","push","filter","element","created_at","format","subtract","length","console","log","catch","e","getTokenError","render"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AAEA,OAAO,aAAP;AAEA,OAAOC,SAAP,MAAsB,aAAtB;;AAEA,MAAMC,KAAN,SAAoBJ,KAAK,CAACK,SAA1B,CAAoC;AAAA;AAAA;AAAA,SAEnCC,KAFmC,GAE3B;AACPC,MAAAA,KAAK,EAAE,EADA;AAEPC,MAAAA,MAAM,EAAE,CACP;AACCC,QAAAA,IAAI,EAAE,EADP;AAECC,QAAAA,IAAI,EAAE;AAFP,OADO;AAFD,KAF2B;;AAAA,SAYnCC,iBAZmC,GAYf,MAAM;AACzB,YAAMC,KAAK,GAAG,KAAKC,KAAL,CAAWC,SAAzB;AACA,YAAMC,MAAM,GAAG;AACdC,QAAAA,OAAO,EAAE;AAAEC,UAAAA,aAAa,EAAG,UAASL,KAAM;AAAjC;AADK,OAAf;AAIAX,MAAAA,KAAK,CAACiB,GAAN,CAAU,sEAAV,EAAkFH,MAAlF,EAEEI,IAFF,CAEOC,MAAM,IAAI;AACf,YAAIA,MAAM,CAACC,MAAP,KAAkB,GAAtB,EAA2B;AAC1B,gBAAMd,KAAK,GAAGa,MAAM,CAACV,IAArB;AACA,eAAKY,QAAL,CAAc;AAAEf,YAAAA,KAAK,EAAEA;AAAT,WAAd;AACA,gBAAMgB,cAAc,GAAG,EAAvB;;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAI,CAArB,EAAwBA,CAAC,EAAzB,EAA6B;AAC5BD,YAAAA,cAAc,CAACE,IAAf,CAAqB,KAAKnB,KAAL,CAAWC,KAAX,CAAiBmB,MAAjB,CAAwBC,OAAO,IAAKzB,MAAM,CAACyB,OAAO,CAACC,UAAT,CAAN,CAA2BC,MAA3B,CAAkC,WAAlC,CAAD,KAAqD3B,MAAM,GAAG4B,QAAT,CAAkBN,CAAlB,EAAqB,MAArB,EAA6BK,MAA7B,CAAoC,WAApC,CAAxF,CAAD,CAA4IE,MAAhK;AACA;;AAAA;AACD,eAAKT,QAAL,CAAc;AAAEd,YAAAA,MAAM,EAAE,CAAC;AAAEC,cAAAA,IAAI,EAAE,aAAR;AAAuBC,cAAAA,IAAI,EAAEa;AAA7B,aAAD;AAAV,WAAd;AACA,SARD,MAQO;AACNS,UAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;AACA;AACD,OAdF,EAcIC,KAdJ,CAcUC,CAAC,IAAI;AACbH,QAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;AACA,aAAKpB,KAAL,CAAWuB,aAAX;AACA,OAjBF;AAkBA,KApCkC;AAAA;;AAsCnCC,EAAAA,MAAM,GAAG;AACR,wBACC;AAAK,MAAA,SAAS,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACC,oBAAC,SAAD;AAAW,MAAA,MAAM,EAAE,KAAK/B,KAAL,CAAWE,MAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADD,CADD;AAKA;;AA5CkC;;AA+CpC,eAAeJ,KAAf","sourcesContent":["import React from 'react';\nimport axios from 'axios';\nimport moment from 'moment';\n\nimport './Stats.css';\n\nimport StatChart from './StatChart';\n\nclass Stats extends React.Component {\n\n\tstate = {\n\t\tstats: [],\n\t\tseries: [\n\t\t\t{\n\t\t\t\tname: \"\",\n\t\t\t\tdata: []\n\t\t\t}\n\t\t]\n\t}\n\n\tcomponentDidMount = () => {\n\t\tconst token = this.props.giveToken\n\t\tconst config = {\n\t\t\theaders: { Authorization: `Bearer ${token}` }\n\t\t}\n\n\t\taxios.get(\"http://ec2-18-218-63-27.us-east-2.compute.amazonaws.com:443/api/logs\", config\n\t\t)\n\t\t\t.then(result => {\n\t\t\t\tif (result.status === 200) {\n\t\t\t\t\tconst stats = result.data\n\t\t\t\t\tthis.setState({ stats: stats })\n\t\t\t\t\tconst classifyResult = []\n\t\t\t\t\tfor (let i = 7; i >= 0; i--) {\n\t\t\t\t\t\tclassifyResult.push((this.state.stats.filter(element => (moment(element.created_at).format('YYYY-MM-D')) === moment().subtract(i, 'days').format('YYYY-MM-D'))).length)\n\t\t\t\t\t};\n\t\t\t\t\tthis.setState({ series: [{ name: \"Activations\", data: classifyResult }] })\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log(\"erreur\")\n\t\t\t\t}\n\t\t\t}).catch(e => {\n\t\t\t\tconsole.log(\"erreur\")\n\t\t\t\tthis.props.getTokenError()\n\t\t\t});\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"Stats\">\n\t\t\t\t<StatChart series={this.state.series} />\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default Stats;\n"]},"metadata":{},"sourceType":"module"}